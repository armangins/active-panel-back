services:
  - type: web
    name: active-panel-backend
    env: node
    plan: free
    # Use Node.js 20 LTS for better MongoDB Atlas compatibility
    # Node.js 22 might have SSL/TLS compatibility issues
    buildCommand: npm install
    startCommand: npm start
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        fromService:
          type: web
          name: active-panel-backend
          property: port
      - key: FRONTEND_URL
        sync: false
        # Set this to your frontend URL (e.g., https://yourdomain.com)
      - key: MONGODB_URI
        fromDatabase:
          name: active-panel-db
          property: connectionString
      - key: SESSION_SECRET
        generateValue: true
        # Render will auto-generate this, or you can set it manually
      - key: ENCRYPTION_KEY
        sync: false
        # IMPORTANT: Set this manually in Render dashboard
        # Generate with: openssl rand -base64 32
      - key: GOOGLE_CLIENT_ID
        sync: false
        # Optional: Set if using Google OAuth
      - key: GOOGLE_CLIENT_SECRET
        sync: false
        # Optional: Set if using Google OAuth
      - key: GOOGLE_CALLBACK_URL
        sync: false
        # Optional: Explicit Google OAuth callback URL
        # Format: https://your-backend.onrender.com/api/auth/google/callback
        # If not set, will auto-construct from BACKEND_URL or service URL

databases:
  - name: active-panel-db
    plan: free
    databaseName: activepanel
    user: activepanel
